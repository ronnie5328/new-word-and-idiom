<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ“ åœ‹å°ç”Ÿå­—å­¸ç¿’æ¨‚åœ’ ğŸ“</title>
  <style>
    :root{
      --primary: #4CAF50;
      --primary-light: #81C784;
      --secondary: #FF9800;
      --accent: #E91E63;
      --bg: #FFF8E1;
      --card: #FFFFFF;
      --text: #2E2E2E;
      --text-light: #666666;
      --border: #E0E0E0;
      --success: #4CAF50;
      --warning: #FF9800;
      --shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    * {
      box-sizing: border-box;
    }
    
    html, body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #FFF8E1 0%, #F3E5F5 100%);
      color: var(--text);
      font-family: "Microsoft JhengHei", "PingFang TC", "Noto Sans TC", sans-serif;
      min-height: 100vh;
    }
    
    /* æ¨™é¡Œå€åŸŸ */
    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      padding: 30px 20px;
      text-align: center;
      box-shadow: var(--shadow);
    }
    
    .header h1 {
      margin: 0;
      font-size: 32px;
      font-weight: bold;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .header .subtitle {
      margin: 10px 0 0;
      font-size: 18px;
      opacity: 0.9;
    }
    
    /* ä¸»è¦å®¹å™¨ */
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 30px 20px;
    }
    
    /* é¸æ“‡å¡ç‰‡ */
    .selection-card {
      background: var(--card);
      border-radius: 20px;
      padding: 30px;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
    }
    
    .selection-title {
      font-size: 24px;
      color: var(--primary);
      margin-bottom: 25px;
      text-align: center;
      font-weight: bold;
    }
    
    /* é¸æ“‡æŒ‰éˆ•å€åŸŸ */
    .selection-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 25px;
    }
    
    .selection-group {
      text-align: center;
    }
    
    .selection-group label {
      display: block;
      font-size: 18px;
      font-weight: bold;
      color: var(--text);
      margin-bottom: 10px;
    }
    
    .selection-group select {
      width: 100%;
      padding: 15px;
      font-size: 20px;
      border: 3px solid var(--border);
      border-radius: 15px;
      background: white;
      color: var(--text);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .selection-group select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
    }
    
    .selection-group select:hover {
      border-color: var(--primary-light);
    }
    
    /* çµ±è¨ˆè³‡è¨Š */
    .stats {
      background: var(--primary);
      color: white;
      padding: 15px 25px;
      border-radius: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      margin-top: 20px;
    }
    
    /* çµæœå¡ç‰‡ */
    .result-card {
      background: var(--card);
      border-radius: 20px;
      padding: 30px;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
    }
    
    .result-title {
      font-size: 24px;
      color: var(--primary);
      margin-bottom: 20px;
      text-align: center;
      font-weight: bold;
    }
    
    .lesson-info {
      background: linear-gradient(135deg, #E8F5E8 0%, #F0F8FF 100%);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 25px;
      text-align: center;
      border: 2px solid var(--primary-light);
    }
    
    .lesson-info p {
      margin: 0;
      font-size: 18px;
      color: var(--text);
    }
    
    /* é€£çµå€åŸŸ */
    .links-section {
      background: linear-gradient(135deg, #E3F2FD 0%, #F3E5F5 100%);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 25px;
      text-align: center;
    }
    
    .link-button {
      display: inline-block;
      background: var(--secondary);
      color: white;
      padding: 15px 25px;
      margin: 10px;
      border-radius: 25px;
      text-decoration: none;
      font-size: 18px;
      font-weight: bold;
      transition: all 0.3s ease;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .link-button:hover {
      background: #F57C00;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }
    
    .link-button.primary {
      background: var(--primary);
    }
    
    .link-button.primary:hover {
      background: #388E3C;
    }
    
    .link-button.accent {
      background: var(--accent);
    }
    
    .link-button.accent:hover {
      background: #C2185B;
    }
    
    /* ç”Ÿå­—è¡¨æ ¼ */
    .words-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .words-table th {
      background: var(--primary);
      color: white;
      padding: 20px;
      font-size: 20px;
      font-weight: bold;
      text-align: center;
    }
    
    .words-table td {
      padding: 20px;
      text-align: center;
      border-bottom: 1px solid var(--border);
      font-size: 18px;
    }
    
    .words-table td:first-child {
      font-size: 36px;
      font-weight: bold;
      color: var(--primary);
      background: #F8F9FA;
    }
    
    .words-table td:last-child {
      font-size: 16px;
    }
    
    .words-table a {
      color: var(--accent);
      text-decoration: none;
      font-weight: bold;
      padding: 8px 15px;
      border-radius: 20px;
      background: #FFE0E6;
      transition: all 0.3s ease;
    }
    
    .words-table a:hover {
      background: var(--accent);
      color: white;
    }
    
    /* é å°¾ */
    .footer {
      background: var(--text);
      color: white;
      padding: 30px 20px;
      text-align: center;
      margin-top: 50px;
    }
    
    .footer small {
      font-size: 14px;
      line-height: 1.6;
      opacity: 0.8;
    }
    
    .footer a {
      color: #81C784;
      text-decoration: none;
    }
    
    .footer a:hover {
      text-decoration: underline;
    }
    
    /* å‹•ç•«æ•ˆæœ */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }
    
    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 24px;
      }
      
      .header .subtitle {
        font-size: 16px;
      }
      
      .selection-grid {
        grid-template-columns: 1fr;
      }
      
      .selection-group select {
        font-size: 18px;
        padding: 12px;
      }
      
      .words-table th,
      .words-table td {
        padding: 15px 10px;
        font-size: 16px;
      }
      
      .words-table td:first-child {
        font-size: 28px;
      }
      
      .link-button {
        display: block;
        margin: 10px 0;
        font-size: 16px;
        padding: 12px 20px;
      }
    }
    
    /* è¼‰å…¥å‹•ç•« */
    .loading {
      text-align: center;
      padding: 40px;
      font-size: 20px;
      color: var(--text-light);
    }
    
    .loading::after {
      content: '';
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid var(--border);
      border-top: 3px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-left: 10px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- æ¨™é¡Œå€åŸŸ -->
  <header class="header">
    <h1>ğŸ“ åœ‹å°ç”Ÿå­—å­¸ç¿’æ¨‚åœ’ ğŸ“</h1>
    <p class="subtitle">ğŸ“š é¸æ“‡ä½ çš„å¹´ç´šå’Œèª²æœ¬ï¼Œä¸€èµ·å­¸ç¿’ç”Ÿå­—å§ï¼</p>
    
  </header>

  <!-- ä¸»è¦å…§å®¹ -->
  <div class="container">
    <!-- é¸æ“‡å€åŸŸ -->
    <div class="selection-card fade-in">
      <h2 class="selection-title">ğŸ¯ è«‹é¸æ“‡å­¸ç¿’å…§å®¹</h2>
      
      <div class="selection-grid">
        <div class="selection-group">
          <label>ğŸ“… å­¸æœŸ</label>
          <select id="term">
            <option value="">è«‹é¸æ“‡å­¸æœŸ</option>
          </select>
        </div>
        
        <div class="selection-group">
          <label>ğŸ‘¦ğŸ‘§ å¹´ç´š</label>
          <select id="grade">
            <option value="">è«‹é¸æ“‡å¹´ç´š</option>
          </select>
        </div>
        
        <div class="selection-group">
          <label>ğŸ“– ç‰ˆæœ¬</label>
          <select id="publisher">
            <option value="">è«‹é¸æ“‡ç‰ˆæœ¬</option>
          </select>
        </div>
        
        <div class="selection-group">
          <label>ğŸ“ èª²åˆ¥</label>
          <select id="lesson">
            <option value="">è«‹é¸æ“‡èª²åˆ¥</option>
          </select>
        </div>
      </div>
      
      <div id="stats" class="stats" style="display: none;"></div>
    </div>

    <!-- çµæœå€åŸŸ -->
    <div id="result-section" class="result-card fade-in" style="display: none;">
      <h2 class="result-title">ğŸ“š å­¸ç¿’å…§å®¹</h2>
      
      <!-- é€£çµå€åŸŸ -->
      <div id="links" class="links-section"></div>
      
      <!-- ç”Ÿå­—è¡¨æ ¼ -->
      <table id="words-table" class="words-table">
        <thead>
          <tr>
            <th>ğŸ”¤ ç”Ÿå­—</th>
            <th>ğŸ“– æˆèªå­¸ç¿’</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- é å°¾ -->
  <footer class="footer">
    <small>
      ğŸ« ç”Ÿå­—è³‡æ–™ä¾†æºï¼š<a href="https://pedia.cloud.edu.tw/Home/CopyRight" target="_blank">æ•™è‚²é›²ã€Œæ•™è‚²ç™¾ç§‘ã€</a><br>
      ğŸ“š æˆèªå­¸ç¿’ï¼š<a href="https://dict.idioms.moe.edu.tw/pageView.jsp?ID=44&la=0&webMd=2" target="_blank">æ•™è‚²éƒ¨ã€Šæˆèªå…¸ã€‹</a><br>
      âœï¸ ç­†é †ç·´ç¿’ï¼š<a href="https://stroke-order.learningweb.moe.edu.tw/page.jsp?ID=52" target="_blank">æ•™è‚²éƒ¨ã€Šåœ‹å­—æ¨™æº–å­—é«”ç­†é †å­¸ç¿’ç¶²ã€‹</a><br>
      ğŸ’¡ æœ¬ç¶²ç«™åƒ…ä¾›å­¸ç¿’ä½¿ç”¨ï¼Œæ‰€æœ‰å…§å®¹ç‰ˆæ¬Šæ­¸åŸç¶²ç«™æ‰€æœ‰
    </small>
  </footer>

  <script>
    // ===== è¨­å®šè³‡æ–™ =====
    const TERMS = [
      { label: "114 å­¸å¹´ä¸Šå­¸æœŸ", code: "11401" },
      { label: "114 å­¸å¹´ä¸‹å­¸æœŸ", code: "11402" }
    ];
    
    const PUB_CODE = { "å—ä¸€": "0102", "åº·è»’": "0103", "ç¿°æ—": "0101" };
    const GRADE_CODE = { "ä¸€å¹´ç´š": "01", "äºŒå¹´ç´š": "02", "ä¸‰å¹´ç´š": "03", "å››å¹´ç´š": "04", "äº”å¹´ç´š": "05", "å…­å¹´ç´š": "06" };
    
    const CATALOG = {
      "114 å­¸å¹´ä¸Šå­¸æœŸ": {
        "ä¸€å¹´ç´š": {
          "åº·è»’": "data/11401/data_11401_åº·è»’_ä¸€å¹´ç´š.json",
          "å—ä¸€": "data/11401/data_11401_å—ä¸€_ä¸€å¹´ç´š.json",
          "ç¿°æ—": "data/11401/data_11401_ç¿°æ—_ä¸€å¹´ç´š.json"
        },
        "äºŒå¹´ç´š": {
          "åº·è»’": "data/11401/data_11401_åº·è»’_äºŒå¹´ç´š.json",
          "å—ä¸€": "data/11401/data_11401_å—ä¸€_äºŒå¹´ç´š.json",
          "ç¿°æ—": "data/11401/data_11401_ç¿°æ—_äºŒå¹´ç´š.json"
        },
        "ä¸‰å¹´ç´š": {
          "åº·è»’": "data/11401/data_11401_åº·è»’_ä¸‰å¹´ç´š.json",
          "å—ä¸€": "data/11401/data_11401_å—ä¸€_ä¸‰å¹´ç´š.json",
          "ç¿°æ—": "data/11401/data_11401_ç¿°æ—_ä¸‰å¹´ç´š.json"
        },
        "å››å¹´ç´š": {
          "åº·è»’": "data/11401/data_11401_åº·è»’_å››å¹´ç´š.json",
          "å—ä¸€": "data/11401/data_11401_å—ä¸€_å››å¹´ç´š.json",
          "ç¿°æ—": "data/11401/data_11401_ç¿°æ—_å››å¹´ç´š.json"
        },
        "äº”å¹´ç´š": {
          "åº·è»’": "data/11401/data_11401_åº·è»’_äº”å¹´ç´š.json",
          "å—ä¸€": "data/11401/data_11401_å—ä¸€_äº”å¹´ç´š.json",
          "ç¿°æ—": "data/11401/data_11401_ç¿°æ—_äº”å¹´ç´š.json"
        },
        "å…­å¹´ç´š": {
          "åº·è»’": "data/11401/data_11401_åº·è»’_å…­å¹´ç´š.json",
          "å—ä¸€": "data/11401/data_11401_å—ä¸€_å…­å¹´ç´š.json",
          "ç¿°æ—": "data/11401/data_11401_ç¿°æ—_å…­å¹´ç´š.json"
        }
      },
      "114 å­¸å¹´ä¸‹å­¸æœŸ": {
        "ä¸€å¹´ç´š": {
          "åº·è»’": "data/11402/data_11402_åº·è»’_ä¸€å¹´ç´š.json",
          "å—ä¸€": "data/11402/data_11402_å—ä¸€_ä¸€å¹´ç´š.json",
          "ç¿°æ—": "data/11402/data_11402_ç¿°æ—_ä¸€å¹´ç´š.json"
        },
        "äºŒå¹´ç´š": {
          "åº·è»’": "data/11402/data_11402_åº·è»’_äºŒå¹´ç´š.json",
          "å—ä¸€": "data/11402/data_11402_å—ä¸€_äºŒå¹´ç´š.json",
          "ç¿°æ—": "data/11402/data_11402_ç¿°æ—_äºŒå¹´ç´š.json"
        },
        "ä¸‰å¹´ç´š": {
          "åº·è»’": "data/11402/data_11402_åº·è»’_ä¸‰å¹´ç´š.json",
          "å—ä¸€": "data/11402/data_11402_å—ä¸€_ä¸‰å¹´ç´š.json",
          "ç¿°æ—": "data/11402/data_11402_ç¿°æ—_ä¸‰å¹´ç´š.json"
        },
        "å››å¹´ç´š": {
          "åº·è»’": "data/11402/data_11402_åº·è»’_å››å¹´ç´š.json",
          "å—ä¸€": "data/11402/data_11402_å—ä¸€_å››å¹´ç´š.json",
          "ç¿°æ—": "data/11402/data_11402_ç¿°æ—_å››å¹´ç´š.json"
        },
        "äº”å¹´ç´š": {
          "åº·è»’": "data/11402/data_11402_åº·è»’_äº”å¹´ç´š.json",
          "å—ä¸€": "data/11402/data_11402_å—ä¸€_äº”å¹´ç´š.json",
          "ç¿°æ—": "data/11402/data_11402_ç¿°æ—_äº”å¹´ç´š.json"
        },
        "å…­å¹´ç´š": {
          "åº·è»’": "data/11402/data_11402_åº·è»’_å…­å¹´ç´š.json",
          "å—ä¸€": "data/11402/data_11402_å—ä¸€_å…­å¹´ç´š.json",
          "ç¿°æ—": "data/11402/data_11402_ç¿°æ—_å…­å¹´ç´š.json"
        }
      }
    };
    
    // ===== èª²åè³‡æ–™ï¼ˆ114 å­¸å¹´ä¸‹å­¸æœŸï¼Œå„å¹´ç´šï¼ç‰ˆæœ¬ï¼‰ =====
    const TITLES = {
      "114 å­¸å¹´ä¸‹å­¸æœŸ": {
        "ä¸€å¹´ç´š": {
          "å—ä¸€": {
            "ç¬¬01èª²": "å¤ªé™½æ˜¯å……é›»æ©Ÿ",
            "ç¬¬02èª²": "æ˜¥é›¨æ˜¯ä»€éº¼é¡è‰²",
            "ç¬¬03èª²": "å±±ä¸­éŸ³æ¨‚æœƒ",
            "ç¬¬04èª²": "æ›¸æ˜¯æˆ‘çš„å¥½æœ‹å‹",
            "ç¬¬05èª²": "é¢¨å–œæ­¡å’Œæˆ‘ç©",
            "ç¬¬06èª²": "é„°å±…çš„å°å­©",
            "ç¬¬07èª²": "ç•«ç•«",
            "ç¬¬08èª²": "çµ¦æ¾é¼ çš„å¡ç‰‡",
            "ç¬¬09èª²": "å¼µå¥¶å¥¶çš„å¯¶è²",
            "ç¬¬10èª²": "äº•è£¡çš„å°é’è›™",
            "ç¬¬11èª²": "åƒæ˜Ÿæ˜Ÿçš„å°é´¨å­",
            "ç¬¬12èª²": "å¿«æ¨‚ä¸æ­¢ä¸€åŠ"
          },
          "åº·è»’": {
            "ç¬¬01èª²": "çœ‹",
            "ç¬¬02èª²": "èŠ±åœ’è£¡æœ‰ä»€éº¼ï¼Ÿ",
            "ç¬¬03èª²": "åª½åª½çš„éŸ³æ¨‚æœƒ",
            "ç¬¬04èª²": "é‹",
            "ç¬¬05èª²": "å°ç¨®å­å¿«é•·å¤§",
            "ç¬¬06èª²": "å¥¶å¥¶çš„å°è·Ÿç­",
            "ç¬¬07èª²": "ä½œå¤¢çš„é›²",
            "ç¬¬08èª²": "å¦¹å¦¹çš„ç´…é›¨é‹",
            "ç¬¬09èª²": "ä¸ƒå½©çš„è™¹",
            "ç¬¬10èª²": "å’Œä½ åœ¨ä¸€èµ·",
            "ç¬¬11èª²": "ç”Ÿæ—¥å¿«æ¨‚",
            "ç¬¬12èª²": "å°é»‘"
          },
          "ç¿°æ—": {
            "ç¬¬01èª²": "æ˜¥å¤©ä¾†äº†",
            "ç¬¬02èª²": "å°é›¨",
            "ç¬¬03èª²": "ç¾å¥½çš„ä¸€å¤©",
            "ç¬¬04èª²": "é€ä»€éº¼å‘¢",
            "ç¬¬05èª²": "çª—å¤–çš„å°éº»é›€",
            "ç¬¬06èª²": "æ¯›æ¯›èŸ²éæ²³",
            "ç¬¬07èª²": "å€Ÿç­†",
            "ç¬¬08èª²": "å…©å¼µå¡ç‰‡",
            "ç¬¬09èª²": "å‹æƒ…çš„æ´æ–",
            "ç¬¬10èª²": "ä¸€æ£µå°æ¨¹",
            "ç¬¬11èª²": "é‰›ç­†å’Œæ©¡çš®æ“¦",
            "ç¬¬12èª²": "ä¸Šè‡ºèªªæ•…äº‹"
          }
        },
        "äºŒå¹´ç´š": {
          "å—ä¸€": {
            "ç¬¬01èª²": "å½©è‰²å¿ƒæƒ…",
            "ç¬¬02èª²": "å‹‡æ•¢è¶…äºº",
            "ç¬¬03èª²": "å°æ³¢æ°£çƒé£›ä¸Šå¤©",
            "ç¬¬04èª²": "å°æ°´ç ï¼Œå»å“ªè£¡?",
            "ç¬¬05èª²": "ç”Ÿæ—¥å¿«æ¨‚",
            "ç¬¬06èª²": "çµ¦åœ°çƒçš„ä¸€å°ä¿¡",
            "ç¬¬07èª²": "å‚˜",
            "ç¬¬08èª²": "è€åœ’ä¸çš„è©±",
            "ç¬¬09èª²": "å°å°èªªæ›¸äºº",
            "ç¬¬10èª²": "é»é‡‘è¡“",
            "ç¬¬11èª²": "æˆ‘å–œæ­¡ä½ ",
            "ç¬¬12èª²": "å¦‚æœï¼Œæˆ‘çš„æˆ¿é–“..."
          },
          "åº·è»’": {
            "ç¬¬01èª²": "æ˜¥å¤©çš„é¡è‰²",
            "ç¬¬02èª²": "èŠ±è¡£è£³",
            "ç¬¬03èª²": "å½©è‰²ç‹åœ‹",
            "ç¬¬04èª²": "çˆ¸çˆ¸",
            "ç¬¬05èª²": "æˆ‘çš„å®¶äºº",
            "ç¬¬06èª²": "æ„›ç¬‘çš„å¤§æ¨¹",
            "ç¬¬07èª²": "æœˆå…‰æ²³",
            "ç¬¬08èª²": "é»ƒç‹—ç”Ÿè›‹",
            "ç¬¬09èª²": "ç¥ç­†é¦¬è‰¯",
            "ç¬¬10èª²": "å°ç†Šçš„é‚€è«‹",
            "ç¬¬11èª²": "å°è®€è€…æ¨‚åœ’",
            "ç¬¬12èª²": "å·¨äººå±±"
          },
          "ç¿°æ—": {
            "ç¬¬01èª²": "ç¨®å­æ—…è¡ŒçœŸå¥‡å¦™",
            "ç¬¬02èª²": "å°æ°´æ»´æ„›ä¸Šæ¢éšª",
            "ç¬¬03èª²": "ç´«æ–‘è¶å‘åŒ—é£›",
            "ç¬¬04èª²": "ä¸€å ´é›¨",
            "ç¬¬05èª²": "ç¬‘å®¹å›ä¾†äº†",
            "ç¬¬06èª²": "å¥½å¥½çš„èªªè©±",
            "ç¬¬07èª²": "è‰²å½©è®Šè®Šè®Š",
            "ç¬¬08èª²": "å­µè›‹çš„ç”·å­©",
            "ç¬¬09èª²": "é»äº®ä¸–ç•Œçš„äºº",
            "ç¬¬10èª²": "é†œå°é´¨",
            "ç¬¬11èª²": "èœ˜è››æ•‘è›‹",
            "ç¬¬12èª²": "ç‰å…”æ—è—¥"
          }
        },
        "ä¸‰å¹´ç´š": {
          "å—ä¸€": {
            "ç¬¬01èª²": "æœ€ç¾çš„æ¨¡æ¨£",
            "ç¬¬02èª²": "ç©ç©å…·",
            "ç¬¬03èª²": "æ„›ç‰çš„è®Šèº«è¡“",
            "ç¬¬04èª²": "æ¥Šä¿®çŒœå­—",
            "ç¬¬05èª²": "å”±åèª¿",
            "ç¬¬06èª²": "ä¸€é£›æ²–å¤©",
            "ç¬¬07èª²": "äº•ä»”è…³é¹½ç”°",
            "ç¬¬08èª²": "å’Œé­šä¸€èµ·æ¸¸æ³³",
            "ç¬¬09èª²": "ä¸‰å³½è€è¡—æ¨‚è—æŸ“",
            "ç¬¬10èª²": "åœ°çƒçš„çœ¼æ·š",
            "ç¬¬11èª²": "æ¯æœ¨æ˜¯å¤§é£¯åº—",
            "ç¬¬12èª²": "é¨æ¨“"
          },
          "åº·è»’": {
            "ç¬¬01èª²": "è¨±é¡˜",
            "ç¬¬02èª²": "ä¸‹é›¨çš„æ™‚å€™",
            "ç¬¬03èª²": "é‡è¦‹ç¾å¦‚å¥¶å¥¶",
            "ç¬¬04èª²": "å·¥åŒ ä¹‹ç¥–",
            "ç¬¬05èª²": "å­¸ç”°é¼ é–‹è·¯",
            "ç¬¬06èª²": "ç¥å¥‡å¯†ç¢¼",
            "ç¬¬07èª²": "æ²¹æ¡èŠ±ï¼äº”æœˆé›ª",
            "ç¬¬08èª²": "å¤§è‡ªç„¶çš„ç¾è¡“é¤¨",
            "ç¬¬09èª²": "è‡ºç£çš„å±±æ¤’é­š",
            "ç¬¬10èª²": "æ¼å¤«å’Œé‡‘é­š",
            "ç¬¬11èª²": "è°æ˜çš„é¼ é¹¿",
            "ç¬¬12èª²": "é‚„è¦è·Œå¹¾æ¬¡"
          },
          "ç¿°æ—": {
            "ç¬¬01èª²": "æ‹”ä¸èµ·ä¾†çš„ç­†",
            "ç¬¬02èª²": "é‚„å·®ä¸€é»",
            "ç¬¬03èª²": "ç”¨è†è“‹è·³èˆçš„å¥³å­©",
            "ç¬¬04èª²": "éœéœçš„æ·¡æ°´æ²³",
            "ç¬¬05èª²": "èŒ¶é„‰é¹¿è°·",
            "ç¬¬06èª²": "æœˆä¸–ç•Œä¹‹æ—…",
            "ç¬¬07èª²": "åšæ³¡èœ",
            "ç¬¬08èª²": "è¡Œäººçš„å®ˆè­·è€…",
            "ç¬¬09èª²": "å°±æ„›å…©å…©åœ¨ä¸€èµ·",
            "ç¬¬10èª²": "é£›è¡Œå“¡å’Œå°ç‹å­",
            "ç¬¬11èª²": "ç•«é¾é»ç›",
            "ç¬¬12èª²": "æ‰é€²ä¸€å€‹å…”å­æ´"
          }
        },
        "å››å¹´ç´š": {
          "å—ä¸€": {
            "ç¬¬01èª²": "ğª¹šé¾æ…¶å…ƒå®µ",
            "ç¬¬02èª²": "çœ‹æˆ²",
            "ç¬¬03èª²": "èˆå§ï¼å°é£›é­š",
            "ç¬¬04èª²": "è¶ä¹‹ç”Ÿ",
            "ç¬¬05èª²": "æ´»å‡ºç”Ÿå‘½å¥‡è¹Ÿ",
            "ç¬¬06èª²": "èµ°éå°±çŸ¥é“",
            "ç¬¬07èª²": "ä¸ä¸€æ¨£çš„æ¯è¦ªèŠ±",
            "ç¬¬08èª²": "å±‹é ‚ä¸Šçš„å°è²“",
            "ç¬¬09èª²": "ç”¨ä¸€å…¬æ–¤æ„›å˜‰æ˜æ¹–",
            "ç¬¬10èª²": "æƒ³åƒèˆ‡ç™¼æ˜",
            "ç¬¬11èª²": "å°äº‹ç‰©ã€€å¤§é©šå¥‡",
            "ç¬¬12èª²": "ä¹è›™å‚³å¥‡"
          },
          "åº·è»’": {
            "ç¬¬01èª²": "ä¸€æŸé®®èŠ±",
            "ç¬¬02èª²": "å¿ƒå‹•ä¸å¦‚è¡Œå‹•",
            "ç¬¬03èª²": "é¸æ‹”å‹•ç‰©ä¹‹æ˜Ÿ",
            "ç¬¬04èª²": "ç±³é£Ÿé£„é¦™",
            "ç¬¬05èª²": "è®€æ›¸å ±å‘Š-è—è‰²å°æ´‹è£",
            "ç¬¬06èª²": "æˆ‘æ„›é¹¿æ¸¯",
            "ç¬¬07èª²": "æœªä¾†çš„æ¨¡æ¨£",
            "ç¬¬08èª²": "å‹•ç‰©è€å¸«çš„æ™ºæ…§",
            "ç¬¬09èª²": "å‘å¤ªç©ºå‡ºç™¼",
            "ç¬¬10èª²": "å°é’è›™æƒ³çœ‹æµ·",
            "ç¬¬11èª²": "çª—å‰çš„æœˆå…‰",
            "ç¬¬12èª²": "å¦‚ä¾†ä½›çš„æ‰‹æŒå¿ƒ"
          },
          "ç¿°æ—": {
            "ç¬¬01èª²": "ç¨»é–“é´¨",
            "ç¬¬02èª²": "ç¶ è‰²é­”æ³•å­¸æ ¡",
            "ç¬¬03èª²": "çŸ³è™å…„å¦¹",
            "ç¬¬04èª²": "é˜¿é‡Œæ£’æ£’",
            "ç¬¬05èª²": "å¿«æ¨‚å…’ç«¥æ—¥",
            "ç¬¬06èª²": "é˜¿å…¬çš„ç§˜å¯†",
            "ç¬¬07èª²": "æ£’çƒè‹±é›„å¤¢",
            "ç¬¬08èª²": "å¤¢å¹»å…¨å£˜æ‰“",
            "ç¬¬09èª²": "å–®è»ŠéŠæ—¥æœˆæ½­",
            "ç¬¬10èª²": "å­«æ‚Ÿç©ºä¸‰å€ŸèŠ­è•‰æ‰‡",
            "ç¬¬11èª²": "æœ€å¾Œä¸€ç‰‡è‘‰å­",
            "ç¬¬12èª²": "é–±è®€èª²"
          }
        },
        "äº”å¹´ç´š": {
          "å—ä¸€": {
            "ç¬¬01èª²": "ç©¿è¶Šæ™‚ç©ºçš„å‘³é“",
            "ç¬¬02èª²": "åœ¨é»‘æš—ä¸­ä¹˜è‘—éŸ³æ¨‚é£›ç¿”",
            "ç¬¬03èª²": "è‰²é¦™å‘³çš„é™½å…‰",
            "ç¬¬04èª²": "ç¸£å®˜å¯©çŸ³é ­",
            "ç¬¬05èª²": "é«˜æ˜èªªè©±è¡“",
            "ç¬¬06èª²": "è®€æ›¸å ±å‘Šâ€”ä½è³€çš„è¶…ç´šé˜¿å¬¤",
            "ç¬¬07èª²": "é­”è¡“å¸«çˆ¸çˆ¸",
            "ç¬¬08èª²": "å…«æ­²ï¼Œä¸€å€‹äººå»æ—…è¡Œ",
            "ç¬¬09èª²": "ç´…é¼»å­é†«ç”Ÿ",
            "ç¬¬10èª²": "æ²‰é»˜çš„å‹•ç‰©åœ’",
            "ç¬¬11èª²": "åœ°ä¸‹è­·è¡›è»",
            "ç¬¬12èª²": "é‡‘å­—å¡”ä¹‹è¬"
          },
          "åº·è»’": {
            "ç¬¬01èª²": "ä½ æœƒæ€éº¼å›ç­”",
            "ç¬¬02èª²": "æ™ºæ•‘é¤Šé¦¬äºº",
            "ç¬¬03èª²": "çœŸæ­£çš„ã€Œè°æ˜ã€",
            "ç¬¬04èª²": "å°è¨˜è€…ï¼Œå‡ºå‹•ï¼",
            "ç¬¬05èª²": "å¥‡å¹»å…‰èŠ’çš„ç¥•å¯†",
            "ç¬¬06èª²": "äººã€Œè²ã€å°±æ˜¯æˆ²",
            "ç¬¬07èª²": "é¡Œè¥¿æ—å£",
            "ç¬¬08èª²": "æµ·æ´‹çš„æ®ºæ‰‹",
            "ç¬¬09èª²": "ä½ æƒ³åšäººé­šå—ï¼Ÿ",
            "ç¬¬10èª²": "ç‰ç±³äººçš„å¥‡è¹Ÿ",
            "ç¬¬11èª²": "å¹¸ç¦çš„ç«è‹—",
            "ç¬¬12èª²": "ç¥è¾²å˜—ç™¾è‰"
          },
          "ç¿°æ—": {
            "ç¬¬01èª²": "éµé‘¾é¼»è©©",
            "ç¬¬02èª²": "å±±èˆ‡æµ·çš„äº¤éŸ¿æ¨‚â€”æ±æµ·å²¸éµé“",
            "ç¬¬03èª²": "æˆ‘çœ¼ä¸­çš„æ±æ–¹ä¹‹æœ€",
            "ç¬¬04èª²": "æ»¿ä¿®å¥³æ¡è¨ªè¨˜",
            "ç¬¬05èª²": "èª°è©²è¢«æ´¾å»éæ´²",
            "ç¬¬06èª²": "å¹¸ç¦çš„å‘³é“",
            "ç¬¬07èª²": "ç”Ÿæ´»æœ‰æ„Ÿâ€”è©©å…©é¦–",
            "ç¬¬08èª²": "æ‡¶äººåŒ…å¤§è§£å¯†",
            "ç¬¬09èª²": "è‰¯è¨€ä¸€å¥ä¸‰å†¬æš–",
            "ç¬¬10èª²": "æ“…é•·æ¨ç†çš„äºº",
            "ç¬¬11èª²": "è‰èˆ¹å€Ÿç®­",
            "ç¬¬12èª²": "ä¸‰å€‹å•é¡Œ"
          }
        },
        "å…­å¹´ç´š": {
          "å—ä¸€": {
            "ç¬¬01èª²": "é¢¨ä¸­é¨å£«",
            "ç¬¬02èª²": "é”é§­é»‘ç†Š",
            "ç¬¬03èª²": "æ¥Šæ°ä¹‹å­",
            "ç¬¬04èª²": "è«‡å¤¢æƒ³",
            "ç¬¬05èª²": "è’‚çƒˆå¨œ",
            "ç¬¬06èª²": "ä¸æ€•",
            "ç¬¬07èª²": "æ‰“é–‹å¿ƒä¸­çš„çª—",
            "ç¬¬08èª²": "åŠªåŠ›æ„›æ˜¥è¯",
            "ç¬¬09èª²": "æ¯ä¸€å€‹å­©å­éƒ½æœ‰ä¸€æ¢è‡ªå·±çš„å°è·¯"
          },
          "åº·è»’": {
            "ç¬¬01èª²": "é¦¬é”åŠ æ–¯åŠ ï¼Œå‡ºç™¼ï¼",
            "ç¬¬02èª²": "æ²‰ç¡çš„å¤©ç©ºä¹‹åŸ",
            "ç¬¬03èª²": "èµ°é€²å¤ªé™½ä¹‹åŸ",
            "ç¬¬04èª²": "é€å‹äºº",
            "ç¬¬05èª²": "èšµé„‰é¢¨æƒ…",
            "ç¬¬06èª²": "ç«¥å¹´â€§å¤æ—¥â€§æ£‰èŠ±ç³–",
            "ç¬¬07èª²": "æˆ‘çš„å°‘å¹´å¤¢",
            "ç¬¬08èª²": "å¦‚ä½•å¼µé–‹è¿½å¤¢çš„ç¿…è†€",
            "ç¬¬09èª²": "æˆç‚ºäººç”Ÿçš„é–‹æ‹“è€…"
          },
          "ç¿°æ—": {
            "ç¬¬01èª²": "éŠèµ°åœ¨ä¸–ç•Œçš„å¸‚å ´è£¡",
            "ç¬¬02èª²": "åˆ°ä¸ä¾†æ¢…ç•¶å€‹æ¨‚å¸«å§",
            "ç¬¬03èª²": "å¤§å°å‰›å¥½çš„é‹å­",
            "ç¬¬04èª²": "ç‹æˆè¾¨è‹¦æ",
            "ç¬¬05èª²": "ç«¥å¹´â€§å¤æ—¥â€§æ£‰èŠ±ç³–",
            "ç¬¬06èª²": "å…’ç«¥çš„ä¿è­·å‚˜",
            "ç¬¬07èª²": "ä½ ç‚ºä½•è€Œå­¸",
            "ç¬¬08èª²": "æˆ‘çš„æ­¦ä¿ å¤§å¤¢",
            "ç¬¬09èª²": "é››é³¥è©¦é£›"
          }
        }
      }
    };
    
    // ===== å·¥å…·å‡½å¼ =====
    const $ = sel => document.querySelector(sel);
    const $$ = sel => document.querySelectorAll(sel);
    
    function termCode(label) {
      const t = TERMS.find(x => x.label === label);
      return t ? t.code : "";
    }
    
    function parseTerm(label) {
      if (!label) return { year: 0, sem: 1 };
      let idx = label.indexOf('å­¸å¹´åº¦');
      if (idx < 0) idx = label.indexOf('å­¸å¹´');
      const year = idx > 0 ? parseInt(label.slice(0, idx).trim(), 10) : 0;
      const sem = (label.includes('ä¸Šå­¸æœŸ') || label.includes('ç¬¬ä¸€å­¸æœŸ')) ? 1 : 2;
      return { year, sem };
    }
    
    function termsSortedDesc() {
      return TERMS.map(t => t.label).sort((a, b) => {
        const A = parseTerm(a), B = parseTerm(b);
        if (B.year !== A.year) return B.year - A.year;
        return B.sem - A.sem;
      });
    }
    
    function lessonNo2(label) {
      const m = label.match(/^ç¬¬(\d{1,2})èª²/);
      return m ? m[1].padStart(2, '0') : '01';
    }
    
    function idiomLink(ch) {
      return `https://dict.idioms.moe.edu.tw/idiomList.jsp?idiom=${encodeURIComponent(ch)}`;
    }
    
    function expectedLessonsCount(grade, pub) {
      if (grade === 'ä¸€å¹´ç´š') {
        return (pub === 'åº·è»’') ? 6 : 7;
      }
      return 12;
    }
    
    function pediaId(termLabel, gradeLabel, pubLabel, lessonLabel) {
      const pub = PUB_CODE[pubLabel] || "";
      const grade = GRADE_CODE[gradeLabel] || "";
      const tcode = termCode(termLabel) || "";
      const les = lessonNo2(lessonLabel);
      return `${pub}${grade}${tcode}${les}`;
    }
    
    // ===== è³‡æ–™è¼‰å…¥ =====
    const CACHE = new Map();
    
    async function ensureDataset(term, grade, pub) {
      const key = `${term}|${grade}|${pub}`;
      if (CACHE.has(key)) return CACHE.get(key);
      
      let data = {};
      const url = (CATALOG?.[term]?.[grade]?.[pub]) || (CATALOG?.[termCode(term)]?.[grade]?.[pub]);
      
      if (url) {
        try {
          const res = await fetch(encodeURI(url), { cache: 'no-cache' });
          if (res.ok) data = await res.json();
        } catch (e) {
          console.error('è¼‰å…¥è³‡æ–™å¤±æ•—:', e);
        }
      }
      
      CACHE.set(key, data);
      return data;
    }
    
    // ===== UI æ§åˆ¶ =====
    function resetSelect(id) {
      $(id).innerHTML = '<option value="">è«‹é¸æ“‡...</option>';
    }
    
    function showLoading() {
      const resultSection = $('#result-section');
      resultSection.style.display = 'block';
      resultSection.innerHTML = '<div class="loading">æ­£åœ¨è¼‰å…¥å­¸ç¿’å…§å®¹...</div>';
    }
    
    function init() {
      const termSel = $('#term');
      termSel.innerHTML = termsSortedDesc().map(x => `<option>${x}</option>`).join('');
      termSel.value = "114 å­¸å¹´ä¸‹å­¸æœŸ";
      updateGrades();
    }
    
    function updateGrades() {
      resetSelect('#grade');
      resetSelect('#publisher');
      resetSelect('#lesson');
      $('#result-section').style.display = 'none';
      $('#stats').style.display = 'none';
      
      const term = $('#term').value;
      const grades = term ? Object.keys(CATALOG[term] || CATALOG[termCode(term)] || {}) : [];
      $('#grade').innerHTML = '<option value="">è«‹é¸æ“‡å¹´ç´š</option>' + grades.map(g => `<option>${g}</option>`).join('');
    }
    
    function updatePublishers() {
      resetSelect('#publisher');
      resetSelect('#lesson');
      $('#result-section').style.display = 'none';
      $('#stats').style.display = 'none';
      
      const term = $('#term').value, grade = $('#grade').value;
      const pubs = (term && grade) ? Object.keys((CATALOG[term] || CATALOG[termCode(term)] || {})[grade] || {}) : [];
      $('#publisher').innerHTML = '<option value="">è«‹é¸æ“‡ç‰ˆæœ¬</option>' + pubs.map(p => `<option>${p}</option>`).join('');
    }
    
    async function updateLessons() {
      resetSelect('#lesson');
      $('#result-section').style.display = 'none';
      $('#stats').style.display = 'none';
      
      const term = $('#term').value, grade = $('#grade').value, pub = $('#publisher').value;
      if (!term || !grade || !pub) return;
      
      showLoading();
      
      const data = await ensureDataset(term, grade, pub);
      window.CURRENT_DATA = data;
      
      let lessons = Object.keys(data || {});
      if (!lessons.length) {
        const n = expectedLessonsCount(grade, pub);
        lessons = Array.from({ length: n }, (_, i) => `ç¬¬${String(i + 1).padStart(2, '0')}èª²`);
      }
      
      lessons.sort((a, b) => (parseInt(lessonNo2(a), 10) - parseInt(lessonNo2(b), 10)));
      
      const termTitles = (TITLES[term] && TITLES[term][grade] && TITLES[term][grade][pub]) || {};
      $('#lesson').innerHTML = '<option value="">è«‹é¸æ“‡èª²åˆ¥</option>' + lessons.map(l => {
        const title = termTitles[l];
        const label = title ? `${l}ï¼š${title}` : l;
        return `<option value="${l}">${label}</option>`;
      }).join('');
      
      $('#result-section').style.display = 'none';
    }
    
    function render() {
      const term = $('#term').value, grade = $('#grade').value, pub = $('#publisher').value, les = $('#lesson').value;
      
      if (!term || !grade || !pub || !les) {
        $('#result-section').style.display = 'none';
        $('#stats').style.display = 'none';
        return;
      }
      
      const chars = (window.CURRENT_DATA || {})[les] || [];
      const id = pediaId(term, grade, pub, les);
      const lessonURL = `https://pedia.cloud.edu.tw/Bookmark/TCollection?TextNameId=${id}`;
      const titleMap = (TITLES[term] && TITLES[term][grade] && TITLES[term][grade][pub]) || {};
      const lessonTitle = titleMap[les];
      const displayLesson = lessonTitle ? `${les}ï¼š${lessonTitle}` : les;
      
      // é¡¯ç¤ºçµ±è¨ˆ
      if (chars.length > 0) {
        $('#stats').textContent = `ğŸ‰ æ‰¾åˆ° ${chars.length} å€‹ç”Ÿå­—è¦å­¸ç¿’ï¼`;
        $('#stats').style.display = 'block';
      } else {
        $('#stats').textContent = `ğŸ“ ${les} - æš«ç„¡ç”Ÿå­—è³‡æ–™`;
        $('#stats').style.display = 'block';
      }
      
      // é¡¯ç¤ºçµæœå€åŸŸ
      $('#result-section').style.display = 'block';
      $('#result-section').innerHTML = `
        <h2 class="result-title">ğŸ“š ${displayLesson} å­¸ç¿’å…§å®¹</h2>
        <div class="lesson-info">
          <p><strong>ğŸ“… ${term}</strong> | <strong>ğŸ‘¦ğŸ‘§ ${grade}</strong> | <strong>ğŸ“– ${pub}</strong></p>
        </div>
        <div id="links" class="links-section"></div>
        <table id="words-table" class="words-table">
          <thead>
            <tr>
              <th>ğŸ”¤ ç”Ÿå­—</th>
              <th>ğŸ“– æˆèªå­¸ç¿’</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      `;
      
      // å»ºç«‹é€£çµ
      const linksSection = $('#links');
      linksSection.innerHTML = `
        <a href="${lessonURL}" target="_blank" rel="noopener" class="link-button primary">
          ğŸ“– æŸ¥çœ‹èª²æ–‡å…§å®¹
        </a>
      `;
      
      // ç­†é †ç·´ç¿’é€£çµ
      if (Array.isArray(chars) && chars.length) {
        const allChars = chars.join('');
        const firstId = allChars.codePointAt(0);
        const strokeURL = `https://stroke-order.learningweb.moe.edu.tw/dictView.jsp?ID=${firstId}&WORD=${encodeURIComponent(allChars)}&ID2=1&TP=0`;
        
        linksSection.innerHTML += `
          <a href="${strokeURL}" target="_blank" rel="noopener" class="link-button accent">
            âœï¸ ç­†é †ç·´ç¿’
          </a>
        `;
      }
      
      // å»ºç«‹ç”Ÿå­—è¡¨æ ¼
      const tbody = $('#words-table tbody');
      tbody.innerHTML = '';
      
      if (chars.length > 0) {
        for (const ch of chars) {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${ch}</td>
            <td>
              <a href="${idiomLink(ch)}" target="_blank" rel="noopener">å­¸ç¿’ã€Œ${ch}ã€çš„æˆèª</a>
              &nbsp;|&nbsp;
              <a href="idiom.html?keyword=${encodeURIComponent(ch)}" target="_blank" rel="noopener">æˆèªå­¸ç¿’èˆ‡æ¸¬é©—</a>
            </td>
          `;
          tbody.appendChild(tr);
        }
      } else {
        // å¦‚æœæ²’æœ‰ç”Ÿå­—è³‡æ–™ï¼Œé¡¯ç¤ºæç¤ºè¨Šæ¯
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td colspan="2" style="text-align: center; padding: 40px; color: var(--text-light); font-size: 18px;">
            ğŸ“ æ­¤èª²æš«ç„¡ç”Ÿå­—è³‡æ–™<br>
            <small style="font-size: 14px; margin-top: 10px; display: block;">
              è«‹é»æ“Šä¸Šæ–¹ã€ŒæŸ¥çœ‹èª²æ–‡å…§å®¹ã€é€£çµæŸ¥çœ‹å®Œæ•´å…§å®¹
            </small>
          </td>
        `;
        tbody.appendChild(tr);
      }
      
      // åŠ å…¥å‹•ç•«æ•ˆæœ
      $('#result-section').classList.add('fade-in');
    }
    
    // ===== äº‹ä»¶ç¶å®š =====
    $('#term').addEventListener('change', () => { updateGrades(); });
    $('#grade').addEventListener('change', () => { updatePublishers(); });
    $('#publisher').addEventListener('change', async () => { await updateLessons(); });
    $('#lesson').addEventListener('change', render);
    
    // ===== å•Ÿå‹•æ‡‰ç”¨ =====
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>